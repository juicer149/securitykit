# ==========================
# Algorithm Selection
# ==========================

# Algorithm to use for password hashing
# Supported: argon2 (default), future: bcrypt, scrypt, etc.
HASH_VARIANT=argon2

# ==========================
# Argon2id Parameters
# ==========================
# Adjust according to your environment and hardware.
# OWASP recommends:
# - Time cost >= 2
# - Memory cost >= 19 MB
# - Parallelism >= 1
# - Hash length >= 32
# - Salt length >= 16
#
# NOTE: Only time_cost, memory_cost and parallelism are currently auto-tuned
# by the benchmark engine. hash_length and salt_length are static.

ARGON2_TIME_COST=6
ARGON2_MEMORY_COST=131072   # KiB (128 MB)
ARGON2_PARALLELISM=4
ARGON2_HASH_LENGTH=32
ARGON2_SALT_LENGTH=16

# ==========================
# Global Pepper
# ==========================
# A secret string applied to all password hashing algorithms.
# Strongly recommended for production.
# If not set, pepper is disabled.
#
# DO NOT commit a real pepper to version control.
PEPPER_VALUE=your-secret-pepper-here

# ==========================
# Password Policy
# ==========================

# Minimum recommended length is 12
PASSWORD_MIN_LENGTH=12

# Policy booleans (set to true/false, yes/no, on/off)
PASSWORD_REQUIRE_UPPER=true
PASSWORD_REQUIRE_LOWER=true
PASSWORD_REQUIRE_DIGIT=true
PASSWORD_REQUIRE_SPECIAL=true

# ==========================
# Bootstrap / Benchmark (Optional)
# ==========================
# AUTO_BENCHMARK:
#   Opt-in flag. If set to 1 (and required Argon2 vars are missing),
#   SecurityKit will run a benchmark on import and generate .env.local
#   with tuned parameters + integrity metadata.
#
# AUTO_BENCHMARK_TARGET_MS:
#   Desired approximate hashing time (median) in milliseconds.
#
# SECURITYKIT_DISABLE_BOOTSTRAP:
#   If set to 1, skips all automatic bootstrap logic (no benchmarking).
#
# SECURITYKIT_ENV:
#   Controls log severity when configuration is incomplete.
#   Recommended: production / development
#
# Default setup below keeps auto benchmarking OFF for safety.
AUTO_BENCHMARK=0
AUTO_BENCHMARK_TARGET_MS=250
SECURITYKIT_DISABLE_BOOTSTRAP=0
SECURITYKIT_ENV=development

# ==========================
# Notes
# ==========================
# 1. For development you can temporarily set AUTO_BENCHMARK=1 to generate .env.local
#    then revert it to 0. Do not commit the generated .env.local.
# 2. In production, explicitly define Argon2 parameters; keep AUTO_BENCHMARK=0.
# 3. Rotate PEPPER_VALUE only with a planned rehash strategy (login-triggered or batch).
