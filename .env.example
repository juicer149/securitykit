# SecurityKit .env.example
# Do NOT commit real secrets. Copy this file to `.env` and adjust values locally.
# `.env.local` is generated by the bootstrap flow when AUTO_BENCHMARK=1 and should not be committed.

# ==========================
# Core selection
# ==========================
# Select which hashing algorithm variant to use. Supported values depend on what is installed/registered.
# Built-ins: argon2 (requires argon2-cffi), bcrypt (requires bcrypt)
HASH_VARIANT=argon2

# ==========================
# Argon2id Parameters (used when HASH_VARIANT=argon2)
# ==========================
# Adjust according to your environment and hardware.
# OWASP guidance (as of recent recommendations):
# - Time cost >= 2
# - Memory cost >= 19 MB
# - Parallelism >= 1
# - Hash length >= 32
# - Salt length >= 16
#
# NOTE:
# - The benchmark engine only auto-tunes: time_cost, memory_cost, parallelism.
# - hash_length and salt_length are static and not auto-tuned.
# - The bootstrap/benchmark export will NEVER include any PEPPER_* keys.

ARGON2_TIME_COST=6
ARGON2_MEMORY_COST=131072   # KiB (128 MB)
ARGON2_PARALLELISM=4
ARGON2_HASH_LENGTH=32
ARGON2_SALT_LENGTH=16

# ==========================
# Bcrypt Parameters (used when HASH_VARIANT=bcrypt)
# ==========================
# Cost factor (aka "rounds"). Typical baseline: 10-12, higher for stronger hardware.
# Uncomment if you use bcrypt.
# BCRYPT_ROUNDS=12

# ==========================
# Pepper (Global)
# ==========================
# SecurityKit applies pepper via a centralized subsystem, before hashing.
# PEPPER is optional but strongly recommended in production. Modes:
# - noop            : no change
# - prefix          : prefix + password
# - suffix          : password + suffix
# - prefix_suffix   : prefix + password + suffix
# - interleave      : insert token every N chars (obfuscation)
# - hmac            : hex(HMAC(key, password))  [cryptographic]
#
# IMPORTANT:
# - Only 'hmac' provides cryptographic strengthening.
# - Bootstrap/benchmark exports NEVER include PEPPER_* keys.
# - Do NOT commit real secrets.

# Enable/disable pepper explicitly (optional; defaults can be set in code)
PEPPER_ENABLED=true

# Choose mode (one of: noop, prefix, suffix, prefix_suffix, interleave, hmac)
PEPPER_MODE=hmac

# HMAC mode settings (required for mode=hmac)
PEPPER_HMAC_KEY=your-strong-secret-key-here
PEPPER_HMAC_ALGO=sha256

# Prefix/suffix modes (examples)
# PEPPER_PREFIX=[PEPPERED]
# PEPPER_SUFFIX=[SALT]

# Interleave mode (examples)
# PEPPER_INTERLEAVE_FREQ=2
# PEPPER_INTERLEAVE_TOKEN=*

# Legacy note: PEPPER_VALUE is deprecated in favor of the structured PEPPER_* keys.
# PEPPER_VALUE is ignored if present.

# ==========================
# Password Policy
# ==========================
# Minimum recommended length is 12
PASSWORD_MIN_LENGTH=12

# Policy booleans (true/false, yes/no, on/off)
PASSWORD_REQUIRE_UPPER=true
PASSWORD_REQUIRE_LOWER=true
PASSWORD_REQUIRE_DIGIT=true
PASSWORD_REQUIRE_SPECIAL=true

# ==========================
# Bootstrap / Benchmark (Optional)
# ==========================
# AUTO_BENCHMARK:
#   If set to 1 AND required hashing params are incomplete, SecurityKit runs the benchmark
#   at startup and writes tuned parameters to .env.local (with integrity metadata).
#   In production, keep this 0 and set explicit parameters instead.
#
# AUTO_BENCHMARK_TARGET_MS:
#   Desired median hashing time in milliseconds (target for tuning).
#
# SECURITYKIT_DISABLE_BOOTSTRAP:
#   If set to 1, skips all automatic bootstrap logic (no benchmarking, no env generation).
#
# SECURITYKIT_ENV:
#   Controls log severity when configuration is incomplete (production/development).
#
# NOTES:
# - Bootstrap respects .env (base) then .env.local (overrides).
# - Generated .env.local includes:
#     GENERATED_BY   and  GENERATED_SHA256   (do not edit these lines).
# - Benchmarking requires the selected policy to define a BENCH_SCHEMA.
# - Concurrency-safe generation if portalocker is available.

AUTO_BENCHMARK=0
AUTO_BENCHMARK_TARGET_MS=250
SECURITYKIT_DISABLE_BOOTSTRAP=0
SECURITYKIT_ENV=development

# ==========================
# Generated metadata (added by bootstrap; shown here for reference only)
# ==========================
# GENERATED_BY=securitykit-bench vX.Y.Z
# GENERATED_SHA256=<integrity-hash>

# ==========================
# Notes
# ==========================
# 1) Development:
#    - You can temporarily set AUTO_BENCHMARK=1 to generate .env.local once,
#      then revert to AUTO_BENCHMARK=0. Do not commit .env.local.
# 2) Production:
#    - Explicitly define hashing parameters; keep AUTO_BENCHMARK=0.
#    - Use PEPPER_MODE=hmac with a strong PEPPER_HMAC_KEY.
# 3) Rotation:
#    - Plan pepper rotation and rehash strategy (login-triggered or batch).
